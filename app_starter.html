<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>앱 다운로드</title>
    
    <!-- Open Graph 메타 태그 (카톡, 페이스북 등 공유시 표시) -->
    <meta property="og:title" content="앱 이름">
    <meta property="og:description" content="지금 앱을 다운로드하세요!">
    <meta property="og:image" content="https://your-domain.com/app-icon.png">
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .container {
            text-align: center;
            padding: 20px;
        }
        
        .loading {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .manual-links {
            margin-top: 30px;
            opacity: 0;
            animation: fadeIn 1s forwards;
            animation-delay: 2s;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .store-button {
            display: inline-block;
            margin: 10px;
            padding: 12px 24px;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .store-button:hover {
            transform: scale(1.05);
        }
        
        .error-message {
            display: none;
            color: #ff6b6b;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loading">앱 스토어로 이동 중...</div>
        <div class="spinner"></div>
        
        <!-- 테스트 안내 메시지 -->
        <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; margin: 20px 0;">
            <p>⚠️ 현재 자동 이동이 비활성화되어 있습니다</p>
            <p style="font-size: 14px;">실제 사용시 94번째 줄 주석을 해제하세요</p>
        </div>
        
        <!-- 자동 리다이렉트가 실패할 경우를 대비한 수동 링크 -->
        <div class="manual-links">
            <p>자동으로 이동되지 않나요?</p>
            <button onclick="redirect()" class="store-button" style="background: #4CAF50; color: white; cursor: pointer;">
                🚀 지금 리다이렉트 테스트
            </button>
            <br><br>
            <p>또는 직접 선택:</p>
            <a href="https://apps.apple.com/app/id6737678222" class="store-button" id="ios-link">
                📱 App Store
            </a>
            <a href="https://play.google.com/store/apps/details?id=com.estherformula.estherpack.android" class="store-button" id="android-link">
                🤖 Google Play
            </a>
        </div>
        
        <div class="error-message" id="error">
            스토어로 이동할 수 없습니다. 위 버튼을 클릭해주세요.
        </div>
    </div>

    <script>
        // ⚠️ 아래 URL들을 실제 앱 스토어 URL로 변경하세요!
        const APP_STORES = {
            ios: 'https://apps.apple.com/app/id6737678222',  // iOS 앱 스토어 URL
            android: 'https://play.google.com/store/apps/details?id=com.estherformula.estherpack.android',  // 안드로이드 플레이스토어 URL
            fallback: 'https://your-website.com'  // 둘 다 아닐 경우 (데스크톱 등) 이동할 URL
        };

        // 앱 스토어 URL 업데이트 (수동 링크용)
        document.getElementById('ios-link').href = APP_STORES.ios;
        document.getElementById('android-link').href = APP_STORES.android;

        function detectOS() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            
            // iOS 감지
            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                return 'ios';
            }
            
            // Android 감지
            if (/android/i.test(userAgent)) {
                return 'android';
            }
            
            // 그 외 (데스크톱 등)
            return 'other';
        }

        function redirect() {
            const os = detectOS();
            let targetUrl;
            
            switch(os) {
                case 'ios':
                    targetUrl = APP_STORES.ios;
                    break;
                case 'android':
                    targetUrl = APP_STORES.android;
                    break;
                default:
                    targetUrl = APP_STORES.fallback;
            }
            
            // 리다이렉트 시도
            try {
                window.location.replace(targetUrl);
            } catch (e) {
                // 에러 발생시 에러 메시지 표시
                document.getElementById('error').style.display = 'block';
            }
        }

        // 페이지 로드 후 약간의 딜레이를 두고 리다이렉트
        // (사용자가 로딩 화면을 볼 수 있도록)
        // ⚠️ 테스트를 위해 자동 이동 비활성화 - 실제 사용시 주석 해제하세요!
        // setTimeout(redirect, 1000);

        // URL 파라미터 처리 (선택사항)
        // 예: redirect.html?campaign=summer2024
        const urlParams = new URLSearchParams(window.location.search);
        const campaign = urlParams.get('campaign');
        
        if (campaign) {
            // 캠페인 파라미터가 있으면 스토어 URL에 추가
            // 이를 통해 어떤 캠페인에서 유입됐는지 추적 가능
            const separator = APP_STORES.ios.includes('?') ? '&' : '?';
            APP_STORES.ios += `${separator}ct=${campaign}`;
            APP_STORES.android += `&referrer=utm_source%3D${campaign}`;
        }
        
        // 디버그 모드 (개발시 유용)
        const debug = urlParams.get('debug');
        // 테스트를 위해 항상 디버그 정보 표시 (실제 사용시 이 부분 삭제)
        if (debug === 'true' || true) {
            console.log('Detected OS:', detectOS());
            console.log('User Agent:', navigator.userAgent);
            console.log('Redirect URLs:', APP_STORES);
            
            // 화면에도 디버그 정보 표시
            const debugInfo = document.createElement('div');
            debugInfo.style.cssText = 'background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; margin-top: 20px; font-size: 14px; text-align: left;';
            debugInfo.innerHTML = `
                <strong>디버그 정보:</strong><br>
                OS: ${detectOS()}<br>
                User Agent: ${navigator.userAgent.substring(0, 100)}...<br>
                iOS URL: ${APP_STORES.ios}<br>
                Android URL: ${APP_STORES.android}
            `;
            document.querySelector('.container').appendChild(debugInfo);
        }
    </script>
</body>
</html>
